<!DOCTYPE html>
<html lang="pt-br">
  <head>


    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chatbot</title>

    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100vh !important;
      }

      #web-messenger-container {
        bottom: 100px !important;
      }

      #web-messenger-container.mobile-open-web-messenger-container {
        bottom: 0 !important;
        max-height: 100vh;
      }

      @media screen and (min-width: 660px) {
        #web-messenger-container,
        #web-messenger-container.mobile-open-web-messenger-container {
          bottom: 100px !important;
          height: calc(100vh - 100px) !important;
        }
      }
    </style>

    <script>
      !(function (o, d, s, e, f) {
        var i,
          a,
          p,
          c = [],
          h = [];
        function t() {
          var t = "5";
          try {
            if (!f) throw new Error(t);
            var e,
              n = "https://cdn.smooch.io/",
              r = "smooch";
            e =
              "string" == typeof this.response
                ? JSON.parse(this.response)
                : this.response;
            var o = f.match(/([0-9]+)\.?([0-9]+)?\.?([0-9]+)?/),
              s = o && o[1],
              i = o && o[2],
              a = o && o[3],
              p = e["v" + s],
              c = e["v" + s + "." + i + ".patch"];
            if (e.url || p || c) {
              var h = d.getElementsByTagName("script")[0],
                u = d.createElement("script");
              if (((u.async = !0), a))
                u.src = c || n + r + "." + f + ".min.js";
              else {
                if (!(5 <= s && p)) throw new Error(t);
                u.src = p;
              }
              h.parentNode.insertBefore(u, h);
            }
          } catch (e) {
            e.message === t && console.error(e);
          }
        }
        o[s] = {
          init: function () {
            i = arguments;
            var t = {
              then: function (e) {
                return h.push({ type: "t", next: e }), t;
              },
              catch: function (e) {
                return h.push({ type: "c", next: e }), t;
              },
            };
            return t;
          },
          on: function () {
            c.push(arguments);
          },
          render: function () {
            a = arguments;
          },
          destroy: function () {
            p = arguments;
          },
        };
        o.__onWebMessengerHostReady__ = function (e) {
          if (
            (delete o.__onWebMessengerHostReady__, (o[s] = e), i)
          )
            for (var t = e.init.apply(e, i), n = 0; n < h.length; n++) {
              var r = h[n];
              t =
                "t" === r.type ? t.then(r.next) : t.catch(r.next);
            }
          a && e.render.apply(e, a),
            p && e.destroy.apply(e, p);
          for (n = 0; n < c.length; n++)
            e.on.apply(e, c[n]);
        };
        var n = new XMLHttpRequest();
        n.addEventListener("load", t),
          n.open(
            "GET",
            "https://" + e + ".webloader.smooch.io/",
            !0
          ),
          (n.responseType = "json"),
          n.send();
      })(window, document, "Smooch", "668bd805d46b43ab81e18fe4", "5");
    </script>
  </head>

  <body>

    <script>
      !function (e, n, t, r) {
        function o() {
          try {
            var e;
            if (
              (e =
                "string" == typeof this.response
                  ? JSON.parse(this.response)
                  : this.response
              ).url
            ) {
              var t = n.getElementsByTagName("script")[0],
                r = n.createElement("script");
              (r.async = !0),
                (r.src = e.url),
                t.parentNode.insertBefore(r, t);
            }
          } catch (e) {}
        }
        var s,
          p,
          a,
          i = [],
          c = [];
        (e[t] = {
          init: function () {
            (s = arguments);
            var e = {
              then: function (n) {
                return (
                  c.push({ type: "t", next: n }),
                  e
                );
              },
              catch: function (n) {
                return (
                  c.push({ type: "c", next: n }),
                  e
                );
              },
            };
            return e;
          },
          on: function () {
            i.push(arguments);
          },
          render: function () {
            p = arguments;
          },
          destroy: function () {
            a = arguments;
          },
        }),
          (e.__onWebMessengerHostReady__ = function (n) {
            if (
              (delete e.__onWebMessengerHostReady__,
              (e[t] = n),
              s)
            )
              for (
                var r = n.init.apply(n, s), o = 0;
                o < c.length;
                o++
              ) {
                var u = c[o];
                r =
                  "t" === u.type
                    ? r.then(u.next)
                    : r.catch(u.next);
              }
            p && n.render.apply(n, p),
              a && n.destroy.apply(n, a);
            for (o = 0; o < i.length; o++)
              n.on.apply(n, i[o]);
          });
        var u = new XMLHttpRequest();
        u.addEventListener("load", o),
          u.open(
            "GET",
            "https://" + r + ".webloader.smooch.io/",
            !0
          ),
          (u.responseType = "json"),
          u.send();
      }(
        window,
        document,
        "Smooch",
        "668bd805d46b43ab81e18fe4"
      );
    </script>

    <script>
      var userData = {};

      function initSmooch() {
        var removeFooterLogo = function (iframe) {
          if (!iframe) {
            iframe = document.querySelector(
              "iframe#web-messenger-container"
            );
          }

          if (iframe) {
            var iframeDocument =
              iframe.contentDocument ||
              iframe.contentWindow.document;
            var container = iframeDocument.querySelector(
              "#container"
            );
            if (container) {
              var wrapper =
                container.querySelector("#wrapper");
              if (wrapper) {
                wrapper.style.width = "100%";
                wrapper.style.height =
                  "calc(100vh - 20px)";
              }
            }
            var logoContainer = iframeDocument.querySelector(
              ".logo"
            );
            if (logoContainer)
              logoContainer.style.display = "none";

            // Este evento dispara quando o widget é aberto
            Smooch.on(
              "widget:opened",
              function () {
                console.log("Widget is opened!");
                iframe.classList.add(
                  "mobile-open-web-messenger-container"
                );
              }
            );

            // Este evento dispara quando o widget é fechado
            Smooch.on(
              "widget:closed",
              function () {
                console.log("Widget is closed!");
                iframe.classList.remove(
                  "mobile-open-web-messenger-container"
                );
              }
            );
          }
        };

        var delegate = {
          beforeDisplay: function (message, data) {
            if (
              message.displayName === "Sol" ||
              message.id === "66b20cf33a8bbabbc59bdb24"
            )
              message.avatarUrl =
                "https://s3.amazonaws.com/kommunicate.io/sampleapp/images/FAQIcon.png";
          },
        };

        Smooch.init({
          integrationId: "668bd805d46b43ab81e18fe4",
          userId: "ID001",
          user: {
            id: "uniqueUserId",
            name: "Nome do usuário",
            properties: {
              email: "exemplo@exemplo.com",
              createdAt: new Date(),
            },
          },
          delegate: delegate,
        })
          .then(function () {
            console.log(
              "Widget Smooch iniciado com sucesso!"
            );
            setTimeout(function () {
              var iframe =
                document.querySelector(
                  "iframe#web-messenger-container"
                );
              removeFooterLogo(iframe);
            }, 5000);
          })
          .catch(function (err) {
            console.error(
              "Erro ao inicializar o widget Smooch:",
              err
            );
          });
      }

      window.onload = initSmooch;
    </script>
  </body>
</html>
