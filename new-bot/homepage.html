<!DOCTYPE html>
<html lang="pt-br">

<head>

 <!-- Google tag (gtag.js) -->
 <script async src="https://www.googletagmanager.com/gtag/js?id=G-E2K5ESX5TD"></script>
 <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
 
   gtag('config', 'G-E2K5ESX5TD');
 </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chatbot</title>

  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      height: 100vh !important;
    }

    #web-messenger-container {
      bottom: 100px !important;
    }

    #web-messenger-container.mobile-open-web-messenger-container {
      bottom: 0 !important;
      max-height: 100vh;
    }

    @media screen and (min-width: 660px) {

      #web-messenger-container,
      #web-messenger-container.mobile-open-web-messenger-container {
        bottom: 100px !important;
        height: calc(100vh - 100px) !important;
      }
    }
  </style>
  <script>
    !(function (o, d, s, e, f) {
      var i,
        a,
        p,
        c = [],
        h = [];
      function t() {
        var t = "5";
        try {
          if (!f)
            throw new Error(t);
          var e,
            n = "https://cdn.smooch.io/",
            r = "smooch";
          e = "string" == typeof this.response
            ? JSON.parse(this.response)
            : this.response;
          var o = f.match(/([0-9]+)\.?([0-9]+)?\.?([0-9]+)?/),
            s = o && o[1],
            i = o && o[2],
            a = o && o[3],
            p = e["v" + s],
            c = e["v" + s + "." + i + ".patch"];
          if (e.url || p || c) {
            var h = d.getElementsByTagName("script")[0],
              u = d.createElement("script");
            if (((u.async = !0), a))
              u.src = c || n + r + "." + f + ".min.js";
            else {
              if (!(5 <= s && p))
                throw new Error(t);
              u.src = p;
            }
            h
              .parentNode
              .insertBefore(u, h);
          }
        } catch (e) {
          e.message === t && console.error(e);
        }
      } (o[s] = {
        init: function () {
          i = arguments;
          var t = {
            then: function (e) {
              return h.push({ type: "t", next: e }),
                t;
            }, catch: function (e) {
              return h.push({ type: "c", next: e }),
                t;
            }
          };
          return t;
        },
        on: function () {
          c.push(arguments);
        },
        render: function () {
          a = arguments;
        },
        destroy: function () {
          p = arguments;
        }
      }), (o.__onWebMessengerHostReady__ = function (e) {
        if ((delete o.__onWebMessengerHostReady__, (o[s] = e), i))
          for (var t = e.init.apply(e, i), n = 0; n < h.length; n++) {
            var r = h[n];
            t = "t" === r.type
              ? t.then(r.next)
              : t.catch(r.next);
          }
        a && e
          .render
          .apply(e, a),
          p && e
            .destroy
            .apply(e, p);
        for (n = 0; n < c.length; n++)
          e
            .on
            .apply(e, c[n]);
      }
        );
      var n = new XMLHttpRequest();
      n.addEventListener("load", t), n.open("GET", "https://" + e + ".webloader.smooch.io/", !0), (n.responseType = "json"), n.send();
    })(window, document, "Smooch", "668bd805d46b43ab81e18fe4", "5");
  </script>
</head>

<body>


  
  <script>
    let userData = {};
    let listenersAdded = false;  // Variável para garantir que os listeners sejam adicionados apenas uma vez
  
    function initSmooch() {
      const removeFooterLogo = (iframe) => {
        if (!iframe) {
          iframe = document.querySelector("iframe#web-messenger-container");
        }
  
        if (iframe) {
          const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
          const container = iframeDocument.querySelector("#container");
          if (container) {
            const wrapper = container.querySelector("#wrapper");
            if (wrapper) {
              wrapper.style.width = "100%";
              wrapper.style.height = "calc(100vh - 20px)";
            }
          }
          const logoContainer = iframeDocument.querySelector(".logo");
          if (logoContainer) logoContainer.style.display = "none";
  
          // Verifica se os listeners já foram adicionados
          if (!listenersAdded) {
            listenersAdded = true;  // Define a variável como true para evitar duplicações

            // Evento de abertura do widget
            Smooch.on('widget:opened', function () {
              console.log('Widget is opened!');
              
              iframe.classList.add("mobile-open-web-messenger-container");
  
              // Envia o evento de abertura do widget para o GA
              gtag('event', 'widget_opened', {
                'event_category': 'Chatbot',
                'event_label': 'Widget aberto'
              });
            });
  
            // Evento de fechamento do widget
            Smooch.on('widget:closed', function () {
              console.log('Widget is closed!');
              iframe.classList.remove("mobile-open-web-messenger-container");
  
              // Envia o evento de fechamento do widget para o GA
              gtag('event', 'widget_closed', {
                'event_category': 'Chatbot',
                'event_label': 'Widget fechado'
              });
            });
  
            // Evento de envio de mensagem
            Smooch.on('message:sent', function () {
              console.log('Mensagem enviada!');
  
              // Envia o evento de mensagem enviada para o GA
              gtag('event', 'message_sent_to_bot', {
                'event_category': 'Chatbot',
                'event_label': 'Mensagem enviada'
              });
            });

            // Evento de recebimento de mensagem
            Smooch.on('message:received', function () {
              console.log('Mensagem recebida!');
  
              // Envia o evento de mensagem recebida para o GA
              gtag('event', 'bot_message_received', {
                'event_category': 'Chatbot',
                'event_label': 'Mensagem recebida'
              });
            });
          }
        }
      };
  
      const delegate = {
        beforeDisplay(message, data) {
          if (message.displayName === "Sol" || message.id === "66b20cf33a8bbabbc59bdb24")
            message.avatarUrl = "https://s3.amazonaws.com/kommunicate-prod.s3/profile_pic/17199458040551719945804085-image204.png";
  
          removeFooterLogo();
          return message;
        }
      };
  
      Smooch
        .init({
          integrationId: "66b4c16a05de41f0900493e1",
          displayStyle: "button",
          canUserSeeConversationList: false,
          buttonIconUrl: "https://s3.amazonaws.com/kommunicate-prod.s3/profile_pic/17199458040551719945804085-image204.png",
          customColors: {
            brandColor: "3D1A4F",
            conversationColor: "80297d"
          },
          menuItems: {
            imageUpload: true,
            fileUpload: true,
            shareLocation: false
          },
          customText: {
            inputPlaceholder: "Escreva sua mensagem...",
            messageDelivered: "Enviada",
            messageRelativeTimeJustNow: "Agora",
            messageRelativeTimeMinute: "{value}m atrás",
            uploadPhoto: "Anexar imagem",
            uploadDocument: "Anexar arquivo",
          },
          businessName: "Sol",
          businessIconUrl: "https://s3.amazonaws.com/kommunicate-prod.s3/profile_pic/17199458040551719945804085-image204.png",
          delegate
        })
        .then(function (data) {
          Smooch.createConversation({
            metadata: {
              isFirstTimeCustomer: true,
            },
  
          }).then((conversation) => {
            console.log("Hello Sunshine");

            gtag('event', 'first_time_customer', {
              'event_category': 'Chatbot',
              'event_label': 'Primeiro atendimento'
            });
          });
          removeFooterLogo();
        })
        .catch(function (err) {
          console.error("Erro na inicialização do Smooch", err);
        });
    }
  
    // Espera o Smooch estar pronto antes de inicializar
    if (window.Smooch) {
      initSmooch();
    } else {
      window.__onWebMessengerHostReady__ = function () {
        initSmooch();
      };
    }
</script>


  
</body>

</html>